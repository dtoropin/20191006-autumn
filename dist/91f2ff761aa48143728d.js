(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{371:function(t,e,n){t.exports=n.p+"ea102967bd273afd4f3eb4383386ac7f.jpg"},378:function(t,e,n){},405:function(t,e,n){"use strict";var r=n(378);n.n(r).a},411:function(t,e,n){"use strict";n.r(e);var r=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("form",{staticClass:"edit-comment",on:{submit:function(e){return e.preventDefault(),t.savedComment(e)}}},[r("div",{staticClass:"download-file"},[r("input",{staticClass:"download-file__input",attrs:{type:"file",accept:"image/jpeg,image/png,image/jpg",id:"photo"},on:{change:t.handleFile}}),r("label",{staticClass:"download-file__label",attrs:{for:"photo"}},[r("div",{staticClass:"download-file__img"},[t.filePreview?r("img",{attrs:{src:t.filePreview,alt:"avatar"}}):t.comment.photo?r("img",{attrs:{src:"https://webdev-api.loftschool.com/"+t.comment.photo,alt:"avatar"}}):r("img",{attrs:{src:n(371),alt:"avatar"}})]),r("span",{staticClass:"download-file__text"},[t._v("Изменить фото")]),t.errorFile?r("span",{staticClass:"download-file__error"},[t._v(t._s(t.errorFile))]):t._e()])]),r("div",{staticClass:"edit-comment__form"},[r("div",{staticClass:"edit-comment__row"},[r("div",{staticClass:"edit-comment__field"},[r("Input",{attrs:{label:"Имя автора",error:t.errorAuthor},model:{value:t.comment.author,callback:function(e){t.$set(t.comment,"author",e)},expression:"comment.author"}})],1),r("div",{staticClass:"edit-comment__field"},[r("Input",{attrs:{label:"Титул автора",error:t.errorOcc},model:{value:t.comment.occ,callback:function(e){t.$set(t.comment,"occ",e)},expression:"comment.occ"}})],1)]),r("div",{staticClass:"edit-comment__field"},[r("Input",{attrs:{label:"Отзыв",type:"textarea",error:t.errorText},model:{value:t.comment.text,callback:function(e){t.$set(t.comment,"text",e)},expression:"comment.text"}})],1),r("div",{staticClass:"edit-comment__btns"},[r("button",{staticClass:"btn-zero",attrs:{type:"button"},on:{click:t.cancelEdit}},[t._v("Отмена")]),r("button",{staticClass:"btn-default"},[t._v("Сохранить")])])])])};r._withStripped=!0;var o=n(93),i=n(343);function a(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function c(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable}))),r.forEach(function(e){s(t,e,n[e])})}return t}function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var m={props:{editComment:Object},data:function(){return{comment:{photo:"",author:"",occ:"",text:""},filePreview:""}},computed:{errorFile:function(){return this.validation.firstError("comment.photo")},errorAuthor:function(){return this.validation.firstError("comment.author")},errorOcc:function(){return this.validation.firstError("comment.occ")},errorText:function(){return this.validation.firstError("comment.text")}},methods:c({},Object(o.b)("comments",["saveComment","updateComment"]),{handleFile:function(t){var e=this,n=this.fileFromForm(t);this.comment.photo=n,this.renderFile(n).then(function(t){return e.filePreview=t})},fileFromForm:function(t){var e=t.target.files||t.dataTransfer.files;if(!e.length)throw new Error("Нет файла");return e[0]},renderFile:function(t){var e=new FileReader;return new Promise(function(n){try{e.readAsDataURL(t),e.onloadend=function(){n(e.result)}}catch(t){throw new Error("Ошибка при чтении файла")}})},cancelEdit:function(){this.validation.reset(),this.$emit("cancelEdit")},savedComment:function(){var t,e=(t=regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$validate();case 3:if(!t.sent){t.next=11;break}e=new FormData,"string"!=typeof this.comment.photo&&e.append("photo",this.comment.photo),e.append("author",this.comment.author),e.append("occ",this.comment.occ),e.append("text",this.comment.text),this.comment.id?this.updateComment([this.comment.id,e]):this.saveComment(e),this.cancelEdit();case 11:t.next=16;break;case 13:throw t.prev=13,t.t0=t.catch(0),new Error(t.t0.response.data.error||t.t0.response.data.message);case 16:case"end":return t.stop()}},t,this,[[0,13]])}),function(){var e=this,n=arguments;return new Promise(function(r,o){var i=t.apply(e,n);function c(t){a(i,r,o,c,s,"next",t)}function s(t){a(i,r,o,c,s,"throw",t)}c(void 0)})});return function(){return e.apply(this,arguments)}}()}),components:{Input:function(){return n.e(1).then(n.bind(null,427))}},validators:{"comment.photo":function(t){return i.Validator.value(t).required("Добавьте фото")},"comment.author":function(t){return i.Validator.value(t).required("Заполните поле")},"comment.occ":function(t){return i.Validator.value(t).required("Заполните поле")},"comment.text":function(t){return i.Validator.value(t).required("Заполните поле")}},created:function(){this.editComment.id&&(this.comment=c({},this.editComment))}},l=(n(405),n(342)),u=Object(l.a)(m,r,[],!1,null,"475615f0",null);u.options.__file="src/admin/components/blocks/CommentEdit.vue";e.default=u.exports}}]);