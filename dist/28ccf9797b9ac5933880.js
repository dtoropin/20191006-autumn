(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{406:function(t,i,e){},490:function(t,i,e){"use strict";var r=e(406);e.n(r).a},654:function(t,i,e){"use strict";e.r(i);var r=function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{staticClass:"edit-work"},[e("h3",{staticClass:"edit-work__title"},[t._v("Редактирование работы")]),e("form",{staticClass:"edit-work__block",on:{submit:function(i){return i.preventDefault(),t.saveWork(i)}}},[e("div",{staticClass:"edit-work__download"},[e("div",{staticClass:"edit-work__file"},[e("input",{staticClass:"edit-work__input",attrs:{type:"file",accept:"image/jpeg,image/png,image/jpg",id:"file"},on:{change:t.handleFile}}),t.errorPhoto?e("span",{staticClass:"edit-work__error"},[t._v(t._s(t.errorPhoto))]):t._e(),t.filePreview?e("div",{staticClass:"edit-work__drop",style:"backgroundImage: url("+t.filePreview+")"},[e("div",{staticClass:"edit-work__subs"},[t.filePreview?t._e():e("span",{staticClass:"edit-work__info"},[t._v("Перетащите или загрузите для загрузки изображения")]),e("label",{staticClass:"btn-default",attrs:{for:"file"}},[t._v("Загрузить")])])]):e("div",{staticClass:"edit-work__drop",style:"backgroundImage: url("+t.srcPhoto+")"},[e("div",{staticClass:"edit-work__subs"},[t.srcPhoto?t._e():e("span",{staticClass:"edit-work__info"},[t._v("Перетащите или загрузите для загрузки изображения")]),e("label",{staticClass:"btn-default",attrs:{for:"file"}},[t._v("Загрузить")])])])])]),e("div",{staticClass:"edit-work__form"},[e("div",{staticClass:"edit-block"},[e("div",{staticClass:"edit-block__field"},[e("Input",{attrs:{label:"Название",error:t.errorTitle},model:{value:t.editTitle,callback:function(i){t.editTitle=i},expression:"editTitle"}})],1),e("div",{staticClass:"edit-block__field"},[e("Input",{attrs:{label:"Ссылка",error:t.errorLink},model:{value:t.editLink,callback:function(i){t.editLink=i},expression:"editLink"}})],1),e("div",{staticClass:"edit-block__field edit-block__field--textarea"},[e("Input",{attrs:{label:"Описание",type:"textarea",error:t.errorDescription},model:{value:t.editDescription,callback:function(i){t.editDescription=i},expression:"editDescription"}})],1),e("div",{staticClass:"edit-block__field"},[e("Input",{attrs:{label:"Теги",error:t.errorTechs},model:{value:t.editTechs,callback:function(i){t.editTechs=i},expression:"editTechs"}})],1),e("div",{staticClass:"edit-block__tags"},[e("ul",{staticClass:"tags"},t._l(t.tagsList,function(i){return e("li",{staticClass:"tags__item"},[t._v(t._s(i)),e("button",{staticClass:"tags__delete",attrs:{type:"button"},on:{click:t.deleteTag}})])}),0)]),e("div",{staticClass:"edit-block__btns"},[e("button",{staticClass:"btn-zero",attrs:{type:"button"},on:{click:t.cancelEdit}},[t._v("Отмена")]),e("button",{staticClass:"btn-default"},[t._v("Сохранить")])])])])])])};r._withStripped=!0;var s=e(343),o={props:{title:"",techs:"",photo:"",link:"",description:""},data:function(){return{editTitle:"",editTechs:"",editPhoto:"",editLink:"",editDescription:"",filePreview:""}},computed:{tagsList:function(){if(this.editTechs&&""!==this.editTechs)return this.editTechs.split(", ")},srcPhoto:function(){if(this.photo)return"https://webdev-api.loftschool.com/"+this.photo},errorPhoto:function(){return this.validation.firstError("editPhoto")},errorTitle:function(){return this.validation.firstError("editTitle")},errorLink:function(){return this.validation.firstError("editLink")},errorDescription:function(){return this.validation.firstError("editDescription")},errorTechs:function(){return this.validation.firstError("editTechs")}},methods:{cancelEdit:function(){this.validation.reset(),this.$emit("cancelEdit")},deleteTag:function(t){var i=new RegExp("".concat(t.target.parentElement.innerText,",? ?")),e=this.editTechs.replace(i,"");this.editTechs=e.replace(/,\s*$/,"")},saveWork:function(){var t=this;this.$validate().then(function(i){if(i){if(t.photo===t.editPhoto&&t.title===t.editTitle&&t.techs===t.editTechs&&t.link===t.editLink&&t.description===t.editDescription)return t.cancelEdit(),!1;var e=new FormData;"string"!=typeof t.editPhoto&&e.append("photo",t.editPhoto),e.append("title",t.editTitle),e.append("link",t.editLink),e.append("description",t.editDescription),e.append("techs",t.editTechs),t.$emit("saveWork",e),t.cancelEdit()}})},handleFile:function(t){var i=this,e=this.fileFromForm(t);this.editPhoto=e,this.renderFile(e).then(function(t){i.filePreview=t})},fileFromForm:function(t){var i=t.target.files||t.dataTransfer.files;if(!i.length)throw new Error("Нет файла");return i[0]},renderFile:function(t){var i=new FileReader;return new Promise(function(e){try{i.readAsDataURL(t),i.onloadend=function(){e(i.result)}}catch(t){throw new Error("Ошибка при чтении файла")}})}},components:{Input:function(){return e.e(0).then(e.bind(null,659))}},validators:{editPhoto:function(t){return s.Validator.value(t).required("Добавьте фото")},editTitle:function(t){return s.Validator.value(t).required("Заполните поле")},editLink:function(t){return s.Validator.value(t).required("Заполните поле").url("Неверный формат url")},editDescription:function(t){return s.Validator.value(t).required("Заполните поле")},editTechs:function(t){return s.Validator.value(t).required("Заполните поле")}},created:function(){this.editTitle=this.title,this.editTechs=this.techs,this.editPhoto=this.photo,this.editLink=this.link,this.editDescription=this.description}},n=(e(490),e(342)),a=Object(n.a)(o,r,[],!1,null,"b461cd38",null);a.options.__file="src/admin/components/blocks/WorkEdit.vue";i.default=a.exports}}]);